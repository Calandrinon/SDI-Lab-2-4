<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UserController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">distributableApplication</a> &gt; <a href="index.source.html" class="el_package">Controller</a> &gt; <span class="el_source">UserController.java</span></div><h1>UserController.java</h1><pre class="source lang-java linenums">package Controller;

import Exceptions.ValidationException;
import Model.User;
import Repository.InMemoryRepository;
import Repository.Repository;

import java.util.ArrayList;
import java.util.List;
import java.util.Optional;
import java.util.function.Predicate;
import java.util.stream.Collectors;
import java.util.stream.StreamSupport;

public class UserController implements IController{
    private final Repository&lt;Integer, User&gt; UserRepository;

<span class="nc" id="L18">    public UserController(Repository&lt;Integer, User&gt; UserRepository) {</span>
<span class="nc" id="L19">        this.UserRepository = UserRepository;</span>
<span class="nc" id="L20">    }</span>

    /**
     * creates and adds to the repository a user
     *
     * @param id must be already found in the repository
     * @param FirstName must be at least one and at most 64 characters long
     * @param LastName must be at least one and at most 64 characters long
     * @param NumberOfTransactions will default to 0
     *
     * @throws RuntimeException
     *              if the element has already been added to the list
     *
     */


    public void add(Integer id, String FirstName, String LastName, Integer NumberOfTransactions) throws ValidationException {
<span class="nc" id="L37">        User user = new User(FirstName, LastName, NumberOfTransactions);</span>
<span class="nc" id="L38">        user.setId(id);</span>
<span class="nc" id="L39">        this.UserRepository.save(user).ifPresent(e -&gt; {throw new RuntimeException(&quot;element already in the list&quot;);});</span>
<span class="nc" id="L40">    }</span>

    /**
     * creates and updates to the repository the user with another one having the same id
     *
     * @param id must be already found in the repository
     * @param FirstName must be at least one and at most 64 characters long
     * @param LastName must be at least one and at most 64 characters long
     * @param NumberOfTransactions will default to 0
     *
     *
     */

    public void update(Integer id, String FirstName, String LastName, Integer NumberOfTransactions) throws Exception {
<span class="nc" id="L54">        User user = new User(FirstName, LastName, NumberOfTransactions);</span>
<span class="nc" id="L55">        user.setId(id);</span>
<span class="nc" id="L56">        this.UserRepository.update(user);</span>
<span class="nc" id="L57">    }</span>

    /**
     *
     * @param id removes from the repository the user having this id
     * @throws Exception
     *              if the element is not found inside the repository
     */

    public void remove(Integer id) throws Exception {
<span class="nc" id="L67">        this.UserRepository.delete(id).orElseThrow(() -&gt; new Exception(&quot;no such user&quot;));</span>
<span class="nc" id="L68">    }</span>

    /**
     *
     * @param pred a given Predicate object
     * @return the list of string transactions matching the given predicate return true when applied
     */

    private List&lt;String&gt; filter(Predicate&lt;User&gt; pred){
<span class="nc" id="L77">        return StreamSupport.stream(this.UserRepository.findAll().spliterator(), false)</span>
<span class="nc" id="L78">                .filter(pred)</span>
<span class="nc" id="L79">                .map(User::toString)</span>
<span class="nc" id="L80">                .collect(Collectors.toList());</span>
    }

    /**
     *
     * @return the a list of String values corresponding to the user objects
     */

    public List&lt;String&gt; getRepository() {
<span class="nc" id="L89">        return filter(p -&gt; true);</span>
    }

    /**
     *
     * @param minimumNumberOfTransactions the lower bound for the Users' number of transactions
     * @return all of the users having more transactions than the given minimum amount
     */

    public List&lt;String&gt; filterByNumberOfTransactions(Integer minimumNumberOfTransactions) {
<span class="nc bnc" id="L99" title="All 2 branches missed.">        return filter(p -&gt; p.getNumberOfTransactions() &gt;= minimumNumberOfTransactions);</span>
    }

    /**
     *
     * @param userID the id of the user you want to obtain
     * @return a User wrapped inside an Optional or an empty Ooptional
     */

     public Optional&lt;User&gt; exists(Integer userID) {
<span class="nc" id="L109">        return this.UserRepository.findOne(userID);</span>
     }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>